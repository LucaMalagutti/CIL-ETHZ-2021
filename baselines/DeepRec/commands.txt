# Additional packages:
tensorflow
scipy

# Convert CIL train data for DeepRec (default 90/10 train/val) (from CIL-2021 folder)
python baselines/DeepRec/data_utils/CIL_data_converter.py data/data_train.csv

# Convert CIL submission data for DeepRec (from CIL-2021 folder)
python baselines/DeepRec/data_utils/CIL_data_converter.py data/sample_submission.csv submission

# Train (from baselines/DeepRec/ folder)
cd baselines\DeepRec
python run.py --gpu_ids 0 --path_to_train_data data/train --path_to_eval_data data/valid --hidden_layers 128,128,256 --non_linearity_type selu --batch_size 128 --logdir model_save --drop_prob 0.65 --optimizer momentum --lr 0.005 --weight_decay 0 --aug_step 1 --noise_prob 0 --num_epochs 50 --summary_frequency 1000

# Train w/o validation (from baselines/DeepRec/ folder)
python run.py --gpu_ids 0 --path_to_train_data data/train --hidden_layers 512,512,1024 --non_linearity_type selu --batch_size 128 --logdir model_save --drop_prob 0.8 --optimizer momentum --lr 0.005 --weight_decay 0 --aug_step 1 --noise_prob 0 --num_epochs 12 --summary_frequency 1000

# Generate predictions (from CIL-2021 folder)
python baselines/DeepRec/infer.py --path_to_train_data baselines/DeepRec/data/train --path_to_eval_data baselines/DeepRec/data/submission --hidden_layers 128,128,256 --non_linearity_type selu --save_path baselines/DeepRec/model_save/model.epoch_49 --drop_prob 0.0 --predictions_path baselines/DeepRec/preds.csv
